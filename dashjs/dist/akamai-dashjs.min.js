var AkamaiRequestModifier=function(){function a(){n=!0,i=m.getSingletonInstance(l,"DashMetrics"),j=m.getSingletonInstance(l,"MetricsModel"),k=m.getSingletonInstance(l,"URIQueryAndFragmentModel")}function b(){s=!0;var a=k.getURIQueryData();a.forEach(function(a){p.indexOf(a.key)!==-1&&(q[a.key]=q[a.key]||{},q[a.key]=a.value)})}function c(a){var b=j.getReadOnlyMetricsFor("stream");return i.getLatestMPDRequestHeaderValueByID(b,a)}function d(a,b,c){var d=a.indexOf("?")===-1?"?":"&";return a+=d+b+"="+(void 0===c?q[b]:c)}function e(e){return n||a(),e.indexOf(".mpd")!==-1?(t=!0,e):(t=!1,s||b(),0===Object.keys(q).length?e:(o===AkamaiRequestModifier.TOKEN_RETURN_QUERY&&q.hasOwnProperty(p[0])&&(r=r||c(p[2]),e=d(e,p[2],r)),q.hasOwnProperty(p[1])&&(e=d(e,p[1])),e))}function f(a){return t?a:(s||b(),o===AkamaiRequestModifier.TOKEN_RETURN_HEADER&&q.hasOwnProperty(p[0])&&(r=r||c(p[2]),a.setRequestHeader(p[2],r)),a)}function g(a){if(a!==AkamaiRequestModifier.TOKEN_RETURN_QUERY&&a!==AkamaiRequestModifier.TOKEN_RETURN_HEADER)throw new Error("Type must be query or header");o=a}function h(){return o}var i,j,k,l=this.context,m=this.factory,n=!1,o=AkamaiRequestModifier.TOKEN_RETURN_QUERY,p=["hdnts","pzk","hdntl"],q={},r=null,s=!1,t=!1,u={modifyRequestURL:e,modifyRequestHeader:f,setTransferMethod:g,getTransferMethod:h};return u};AkamaiRequestModifier.TOKEN_RETURN_QUERY="query",AkamaiRequestModifier.TOKEN_RETURN_HEADER="header";